#!/bin/bash

# ============================================
# Git Post-Merge Hook (after git pull)
# Doppler Development â†’ .env.local ìë™ ë‹¤ìš´ë¡œë“œ
# ============================================

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SYNC_SCRIPT="$SCRIPT_DIR/sync-doppler.sh"

# sync-doppler.sh ìŠ¤í¬ë¦½íŠ¸ê°€ ìˆëŠ”ì§€ í™•ì¸
if [ ! -f "$SYNC_SCRIPT" ]; then
  # WHCommon/scripts ê²½ë¡œì—ì„œ ì°¾ê¸°
  SYNC_SCRIPT="$(git rev-parse --show-toplevel)/WHCommon/scripts/sync-doppler.sh"
fi

if [ ! -f "$SYNC_SCRIPT" ]; then
  echo "âš ï¸  Warning: sync-doppler.sh not found. Skipping Doppler download."
  exit 0
fi

# Dopplerì—ì„œ ìµœì‹  í™˜ê²½ë³€ìˆ˜ ë‹¤ìš´ë¡œë“œ
echo "ğŸ“¥ Syncing Doppler Development to .env.local..."
bash "$SYNC_SCRIPT" download dev || {
  echo "âš ï¸  Warning: Failed to download from Doppler."
  exit 0
}

exit 0
