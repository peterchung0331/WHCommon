# 신규 개발자 온보딩 가이드

WorkHub 프로젝트에 오신 것을 환영합니다! 이 가이드는 신규 개발자가 로컬 개발 환경을 구축하는 방법을 안내합니다.

## 1. 필수 도구 설치

### 1.1 기본 개발 도구
- **Node.js**: v18 이상 (LTS 버전 권장)
- **npm**: v9 이상 (Node.js와 함께 설치됨)
- **Git**: 최신 버전
- **PostgreSQL**: v14 이상 (로컬 개발용)

### 1.2 코드 검색 도구 (권장)

WorkHub 프로젝트는 grep보다 빠르고 강력한 코드 검색 도구를 사용합니다.

#### 1.2.1 ripgrep 설치
grep 대비 30배 빠른 텍스트 검색 도구입니다.

```bash
# Ubuntu/WSL
sudo apt update
sudo apt install ripgrep

# macOS
brew install ripgrep

# 설치 확인
rg --version
```

#### 1.2.2 ast-grep 설치
AST 기반 코드 구조 검색 및 리팩토링 도구입니다.

```bash
# npm으로 전역 설치
npm install -g @ast-grep/cli

# 설치 확인
sg --version
```

#### 1.2.3 Claude Context Local 설치 (선택)
자연어로 코드를 검색할 수 있는 시맨틱 검색 MCP 서버입니다.

```bash
# 1. uv 설치 및 PATH 추가
curl -fsSL https://raw.githubusercontent.com/FarhanAliRaza/claude-context-local/main/scripts/install.sh | bash
source ~/.local/bin/env

# 2. HuggingFace 계정 생성 및 로그인
# https://huggingface.co 에서 계정 생성
# https://huggingface.co/settings/tokens 에서 Fine-grained 토큰 생성
# - "Read access to contents of all public gated repos you can access" 체크

cd ~/.local/share/claude-context-local
source .venv/bin/activate
huggingface-cli login --token <YOUR_TOKEN>

# 3. EmbeddingGemma 모델 접근 권한 요청
# https://huggingface.co/google/embeddinggemma-300m 에서 "Accept license and access repository" 클릭

# 4. 모델 다운로드 (권한 승인 후)
python -c "from sentence_transformers import SentenceTransformer; SentenceTransformer('google/embeddinggemma-300m', cache_folder='/home/$USER/.claude_code_search/models')"

# 5. Claude Code MCP 등록
claude mcp add code-search --scope user -- uv run --directory ~/.local/share/claude-context-local python mcp_server/server.py
```

**사용 예시:**
```bash
# ripgrep: 빠른 텍스트 검색
rg "function.*Auth" --type ts

# ast-grep: 코드 구조 검색
sg -p 'async function $NAME($$$) { $$$ }' --lang typescript

# Claude Context Local: 자연어 검색 (Claude Code에서)
claude
> index this codebase
> 사용자 인증 처리하는 함수 찾아줘
```

**상세 가이드**: [grep-대안-도구-사용법.md](/home/peterchung/WHCommon/문서/가이드/grep-대안-도구-사용법.md)

### 1.3 WSL 설정 (Windows 사용자)
프로젝트는 WSL(Windows Subsystem for Linux)에서 개발합니다.

```powershell
# PowerShell (관리자 권한)에서 실행
wsl --install
```

## 2. 저장소 클론

### 2.1 GitHub SSH 키 설정 (WSL)

```bash
# SSH 키 생성
ssh-keygen -t ed25519 -C "your_email@example.com"

# SSH 에이전트 시작
eval "$(ssh-agent -s)"
ssh-add ~/.ssh/id_ed25519

# 공개 키 출력 (GitHub에 등록)
cat ~/.ssh/id_ed25519.pub
```

GitHub 설정에서 SSH 키 등록:
1. GitHub > Settings > SSH and GPG keys
2. "New SSH key" 클릭
3. 위에서 출력된 공개 키 복사하여 붙여넣기

### 2.2 SSH 설정 파일 생성

```bash
cat >> ~/.ssh/config << 'EOF'
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_ed25519
    IdentitiesOnly yes
EOF
```

### 2.3 프로젝트 클론

```bash
# 작업 디렉토리 생성
mkdir -p ~/GitHub
cd ~/GitHub

# WBHubManager 클론 (공용 폴더 포함)
git clone git@github.com:peterchung0331/WBHubManager.git
cd WBHubManager

# 다른 Hub 프로젝트 (필요시)
# git clone git@github.com:peterchung0331/WBSalesHub.git
# git clone git@github.com:peterchung0331/WBFinHub.git
```

## 3. 환경변수 설정

### 3.1 환경변수 파일 생성

```bash
# WBHubManager 환경변수 설정
cd ~/GitHub/WBHubManager
cp .env.template .env.local

# HWTestAgent 환경변수 설정 (필요시)
cd ~/GitHub/WBHubManager/HWTestAgent
cp .env.template .env.local
```

### 3.2 환경변수 값 채우기

`.env.local` 파일을 편집하여 필수 값들을 입력합니다.

**필수 항목**:
- `DATABASE_URL`: PostgreSQL 연결 URL
- `GOOGLE_CLIENT_ID`: Google OAuth 클라이언트 ID
- `GOOGLE_CLIENT_SECRET`: Google OAuth 클라이언트 시크릿
- `SESSION_SECRET`: 세션 암호화 키
- `JWT_PUBLIC_KEY`: JWT 공개 키
- `JWT_PRIVATE_KEY`: JWT 개인 키

**값 얻는 방법**:
1. **DATABASE_URL**: 팀 리더에게 로컬 DB 접속 정보 요청 또는 로컬 PostgreSQL 설치
2. **Google OAuth**: 팀 리더에게 개발용 클라이언트 정보 요청
3. **SESSION_SECRET**: 생성 명령어 실행
   ```bash
   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
   ```
4. **JWT Keys**: 팀 리더에게 개발용 키 요청 또는 신규 생성

### 3.3 Doppler 설정 (선택)

Doppler는 환경변수 동기화를 위해 사용됩니다. Git Hook이 자동으로 처리하므로 별도 설정 불필요합니다.

## 4. 데이터베이스 설정

### 4.1 로컬 PostgreSQL 설치 (선택)

```bash
# WSL에서 PostgreSQL 설치
sudo apt update
sudo apt install postgresql postgresql-contrib

# PostgreSQL 시작
sudo service postgresql start

# 데이터베이스 생성
sudo -u postgres psql
CREATE DATABASE hubmanager;
CREATE USER workhub WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE hubmanager TO workhub;
\q
```

### 4.2 Prisma 마이그레이션

```bash
cd ~/GitHub/WBHubManager

# 의존성 설치
npm install

# Prisma 마이그레이션 실행
npx prisma migrate dev

# Prisma Client 생성
npx prisma generate
```

## 5. 프로젝트 실행

### 5.1 개발 서버 시작

```bash
# WBHubManager
cd ~/GitHub/WBHubManager
npm run dev

# 다른 터미널에서 Frontend 실행 (필요시)
cd ~/GitHub/WBHubManager/frontend
npm run dev
```

### 5.2 접속 확인

- **Frontend**: http://localhost:3090
- **Backend API**: http://localhost:4090/api/health

## 6. Git Hook 설정

Git Hook은 자동으로 설정됩니다. 다음 작업이 자동으로 수행됩니다:

- **커밋 전**: `.env.local` → Doppler Development 동기화
- **Pull 후**: Doppler Development → `.env.local` 동기화
- **배포 전**: Doppler Production → `.env.prd` 생성

Hook 설정 확인:
```bash
ls -la .git/hooks/
```

## 7. 환경변수 관리 규칙

### 로컬 개발 환경
- ✅ `.env.local` 파일 사용
- ✅ Git에 커밋하지 않음 (`.gitignore`에 포함)
- ✅ 커밋 시 자동으로 Doppler에 동기화
- ✅ Pull 시 자동으로 Doppler에서 동기화

### 환경변수 변경 시
1. `.env.local` 파일 직접 편집
2. `git commit` 실행 → 자동으로 Doppler에 업로드
3. 팀원이 `git pull` → 자동으로 `.env.local` 업데이트

### 주의사항
- ❌ `.env.local` 파일을 절대 Git에 커밋하지 마세요
- ❌ 민감한 정보를 코드에 하드코딩하지 마세요
- ✅ 필수 환경변수가 누락되지 않았는지 확인하세요
- ✅ 환경변수 값을 변경하면 팀원에게 알려주세요

## 8. 문제 해결

### 환경변수 누락 에러
```bash
# .env.template과 .env.local 비교
diff .env.template .env.local
```

### Doppler 동기화 실패
```bash
# Git Hook 로그 확인
cat .git/hooks/pre-commit
cat .git/hooks/post-merge
```

### 데이터베이스 연결 실패
```bash
# PostgreSQL 실행 확인
sudo service postgresql status

# 데이터베이스 접속 테스트
psql -U workhub -d hubmanager -h localhost
```

### Port 충돌
```bash
# 포트 사용 확인
sudo netstat -tulpn | grep 3090
sudo netstat -tulpn | grep 4090

# 프로세스 종료
kill -9 <PID>
```

## 9. 다음 단계

온보딩이 완료되었다면:

1. **프로젝트 구조 파악**: `WHCommon/claude-context.md` 읽기
2. **기능 리스트 확인**: `WHCommon/기능-리스트.md` 읽기
3. **배포 가이드 숙지**: `WHCommon/배포-가이드-오라클.md` 읽기
4. **첫 이슈 할당받기**: 팀 리더에게 요청

## 10. 도움 요청

문제가 생기면:
- 팀 채널에서 질문하기
- 이 문서의 문제 해결 섹션 참고
- 팀 리더에게 직접 연락

---
마지막 업데이트: 2026-01-14
