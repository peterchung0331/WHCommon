# Rule: Generating a Product Requirements Document (PRD)

> **상세 가이드**: [실행_기획-상세.md](./실행_기획-상세.md) | **WorkHub 특화**: [실행_기획-WorkHub.md](./실행_기획-WorkHub.md)

---

## Quick Start (5분 가이드)

### PRD 작성 순서
```
1. 명확화 질문 (5분)     → AskUserQuestion으로 핵심 질문 4-8개
2. 핵심 섹션 작성 (20분) → Overview, Goals, User Stories, FR
3. 기술 섹션 작성 (15분) → Technical, NFR, Security
4. 검증 섹션 작성 (10분) → Test Strategy, Success Metrics
```

### 필수 vs 선택 섹션

| 구분 | 섹션 | 작성 기준 |
|------|------|----------|
| **필수** | 1-5, 8-10, 13 | 모든 PRD |
| **조건부** | 6-7 (Design, Technical) | UI/기술 변경 시 |
| **조건부** | 11-12 (Phases, Risk) | 대규모 기능 또는 마이그레이션 |
| **조건부** | 14 (Open Questions) | 미결정 사항 있을 때 |

### 저장 위치
- **파일명**: `prd-[feature-name].md`
- **경로**: `/home/peterchung/WHCommon/기획/진행중/`
- **완료 시**: `/home/peterchung/WHCommon/기획/완료/`로 이동

---

## PRD 작성 워크플로우

### Step 1: 기능 유형 파악

```
기능 유형 파악
    ├── 신규 기능      → 질문 8-12개, Template 1+2+4
    ├── 버그 수정      → 질문 3-4개, Template 1만
    ├── 리팩토링       → 질문 6-8개, Template 1+3
    └── 인프라 변경    → 질문 8-12개, Template 1+3+4
```

### Step 2: 명확화 질문 (AskUserQuestion 사용)

#### 복잡도별 권장 질문 수

| 복잡도 | 예상 FR 수 | 권장 질문 수 | 필수 템플릿 |
|--------|-----------|-------------|------------|
| 낮음 | 1-5 | 4개 | Template 1 |
| 중간 | 6-15 | 8개 | Template 1, 2 |
| 높음 | 16+ | 12개 | Template 1-4 |

#### 질문 템플릿 요약

| 템플릿 | 용도 | 핵심 질문 |
|--------|------|----------|
| **Template 1** | 목표/문제 | "이 기능의 주요 목표는?", "해결하려는 문제는?" |
| **Template 2** | 범위/경계 | "적용될 허브는?", "포함하지 않을 것은?" |
| **Template 3** | 기술 접근 | "배포 환경은?", "호환성 처리 방법은?" |
| **Template 4** | WorkHub 특화 | "허브 간 통신 필요?", "환경변수 관리 방법?" |

> **상세 템플릿 코드**: [실행_기획-상세.md - 명확화 질문 템플릿](./실행_기획-상세.md#명확화-질문-템플릿)

### Step 3: PRD 작성

#### PRD 14개 섹션 구조

| # | 섹션 | 필수 | 설명 |
|---|------|------|------|
| 1 | Introduction/Overview | O | 기능 설명 및 문제 정의 |
| 2 | Goals | O | 측정 가능한 목표 |
| 3 | User Stories | O | 사용자 관점 요구사항 |
| 4 | Functional Requirements | O | 구체적 기능 목록 |
| 5 | Non-Goals | O | 범위 제외 항목 |
| 6 | Design Considerations | △ | UI/UX 요구사항 |
| 7 | Technical Considerations | △ | 기술적 제약/의존성 |
| 8 | Non-Functional Requirements | O | 성능, 가용성, 확장성 |
| 9 | Security Requirements | O | 인증, 권한, 데이터 보호 |
| 10 | Test Strategy | O | 테스트 계획 및 커버리지 |
| 11 | Implementation Phases | △ | 단계별 구현 계획 (FR 20개 이상) |
| 12 | Risk & Mitigation | △ | 위험 요소 및 롤백 전략 |
| 13 | Success Metrics | O | 성공 측정 기준 |
| 14 | Open Questions | △ | 미결정 사항 |
| 15 | 작업량 | O | 작업량 추정 (WU 기준) |

> **섹션별 상세 가이드**: [실행_기획-상세.md - 섹션 가이드라인](./실행_기획-상세.md#섹션별-가이드라인)

### 작업량 추정 (필수)

모든 PRD에 작업량 섹션을 포함합니다:

```markdown
## 15. 작업량

- **작업량**: X일 (X WU)
- **파일**: X개
- **LOC**: ~X줄
- **복잡도**: 낮음/중간/높음
```

**WU (Work Unit) 기준**:
- 1 WU = 초급 개발자 1시간 작업량
- 1일 = 8 WU

**복잡도별 가이드**:
| 복잡도 | 예상 WU | 예시 |
|--------|---------|------|
| 낮음 | 1-4 WU | 단일 파일 수정, 설정 변경 |
| 중간 | 5-16 WU | 여러 파일 수정, 새 컴포넌트 |
| 높음 | 17+ WU | 아키텍처 변경, 다중 허브 |

---

## 허브별 적용 가이드

### 허브별 적용 매트릭스 템플릿

PRD 작성 시 아래 표를 복사하여 작성:

```markdown
### 허브별 적용 매트릭스

| 기능/설정 | HubManager | SalesHub | FinHub | OnboardingHub |
|----------|------------|----------|--------|---------------|
| 이 기능 적용 | ✓/✗ | ✓/✗ | ✓/✗ | ✓/✗ |
| 추가 환경변수 | - | - | - | - |
| 특이사항 | SSO 중앙 | CRM 기능 | 금융 규제 | Vision API |
```

### 허브별 FR 그룹화 규칙

```markdown
## 4. Functional Requirements

### FR-공통 (모든 허브)
- FR-C1: [공통 기능 1]
- FR-C2: [공통 기능 2]

### FR-HubManager (적용 시에만)
- FR-HM1: [HubManager 전용 기능]

### FR-SalesHub (적용 시에만)
- FR-SH1: [SalesHub 전용 기능]

### FR-해당없음
- FinHub: [미적용 사유]
- OnboardingHub: [미적용 사유]
```

### 환경별 설정 표 템플릿

PRD의 Technical Considerations 섹션에 필수 포함:

```markdown
### 환경별 설정

| 항목 | 로컬 (.env.local) | 스테이징 (.env.staging) | 프로덕션 (.env.prd) |
|------|------------------|------------------------|-------------------|
| PORT | [허브별 포트] | 4400 | 4500 |
| NODE_ENV | development | production | production |
| DEV_LOGIN | 활성화 | 비활성화 | 비활성화 |
| [추가 변수] | [값] | [값] | [값] |
```

> **환경별 상세 체크리스트**: [실행_기획-WorkHub.md - Appendix A](./실행_기획-WorkHub.md#a-환경별-구성-체크리스트)

---

## 섹션 간 추적성 (Traceability)

PRD 작성 완료 후 아래 표로 요구사항 추적:

```markdown
### 요구사항 추적 매트릭스

| User Story | Functional Req | Test Case | Success Metric |
|------------|---------------|-----------|----------------|
| US-1 | FR-1.1, FR-1.2 | TC-001, TC-002 | SM-1 |
| US-2 | FR-2.1 | TC-003 | SM-2 |
| US-3 | FR-3.1, FR-3.2 | TC-004, TC-005 | SM-3 |
```

---

## 핵심 체크리스트

### PRD 작성 전
- [ ] 기능 유형 파악 (신규/버그/리팩토링/인프라)
- [ ] 복잡도 판단 (낮음/중간/높음)
- [ ] 명확화 질문 완료 (AskUserQuestion 사용)

### PRD 작성 중
- [ ] 모든 필수 섹션 작성 (1-5, 8-10, 13)
- [ ] 허브별 적용 매트릭스 포함 (다중 허브 적용 시)
- [ ] 환경별 설정 표 포함
- [ ] User Story → FR → Test Case 추적성 확인

### PRD 작성 후
- [ ] 파일 저장: `/기획/진행중/prd-[feature-name].md`
- [ ] 구현 시작 전 사용자 검토 완료
- [ ] Task 문서 생성 필요 시: [실행_작업.md](./실행_작업.md) 참조
- [ ] 구현 완료 시: `/기획/완료/`로 이동

---

## 모범 사례 PRD

| 유형 | 예시 문서 | 참고 포인트 |
|------|----------|------------|
| 기본 기능 | [prd-hub-sso-redirect-improvement.md](../기획/진행중/prd-hub-sso-redirect-improvement.md) | User Stories, Security 섹션 |
| 대규모 기능 | [prd-unified-permission-control.md](../기획/진행중/prd-unified-permission-control.md) | Implementation Phases, API 명세 |
| 인프라 변경 | [prd-oracle-cloud-migration.md](../기획/진행중/prd-oracle-cloud-migration.md) | Risk & Mitigation, 환경별 설정 |
| 테스트 개선 | [prd-testagent-improvement.md](../기획/진행중/prd-testagent-improvement.md) | Test Strategy, Success Metrics |

---

## 관련 문서

| 문서 | 용도 | 링크 |
|------|------|------|
| **실행_기획-상세.md** | 전체 섹션 가이드라인, 템플릿 코드 | [바로가기](./실행_기획-상세.md) |
| **실행_기획-WorkHub.md** | WorkHub 특화 부록 (A-F), FAQ | [바로가기](./실행_기획-WorkHub.md) |
| **실행_작업.md** | PRD → Task 변환 가이드 | [바로가기](./실행_작업.md) |

---

**Last Updated**: 2026-01-14
