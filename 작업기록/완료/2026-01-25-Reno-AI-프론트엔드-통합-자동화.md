# Reno AI í”„ë¡ íŠ¸ì—”ë“œ í†µí•© ë° ìë™í™”

**ì‘ì—…ì¼**: 2026. 01. 25.
**í”„ë¡œì íŠ¸**: WBSalesHub
**ì‘ì—…ëŸ‰**: 2ì¼ (16 WU)
**ê´€ë ¨ PRD**: `/home/peterchung/WHCommon/ê¸°íš/ì§„í–‰ì¤‘/PRD-Reno-AI-Integration.md`

## ì‘ì—… ê°œìš”

ì´ë¯¸ êµ¬í˜„ëœ Reno AI ë°±ì—”ë“œ ê¸°ëŠ¥(ë¯¸íŒ… ë¸Œë¦¬í•‘, íŒ”ë¡œì—… ë©”ì¼, ê³ ê° ê±´ê°•ë„)ì„ ì‹¤ì œ ì‚¬ìš©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í”„ë¡ íŠ¸ì—”ë“œì— í†µí•©í•˜ê³ , ìë™í™” í¬ë¡  ì‘ì—…ì„ ì¶”ê°€í•˜ì—¬ ì‹¤ì‚¬ìš© ê°€ëŠ¥í•œ ìƒíƒœë¡œ ì™„ì„±í–ˆìŠµë‹ˆë‹¤.

### ë¬¸ì œì 
- ë°±ì—”ë“œ AI ê¸°ëŠ¥ì€ ì™„ë²½í•˜ê²Œ êµ¬í˜„ë˜ì–´ ìˆì—ˆìœ¼ë‚˜ **í”„ë¡ íŠ¸ì—”ë“œ í†µí•© 0%**
- AISidebar ì»´í¬ë„ŒíŠ¸ëŠ” ì¡´ì¬í•˜ì§€ë§Œ ì–´ë–¤ í˜ì´ì§€ì—ë„ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
- ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ IDë¥¼ ì…ë ¥í•´ì•¼ë§Œ AI ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
- ìë™ íŠ¸ë¦¬ê±° ë° ì•Œë¦¼ ê¸°ëŠ¥ ì—†ìŒ

### í•´ê²° ë°©ì•ˆ
3ë‹¨ê³„ ì ì§„ì  í†µí•©:
1. **Phase 1**: ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ë¥¼ í˜ì´ì§€ì— í†µí•©
2. **Phase 2**: ìë™ íŠ¸ë¦¬ê±° ë° ìƒˆ UI ì¶”ê°€
3. **Phase 3**: í¬ë¡  ì‘ì—…ìœ¼ë¡œ ìë™í™”

---

## Phase 1: ê¸°ë³¸ í†µí•©

**ì»¤ë°‹**: `f33fd33`
**ì‘ì—… ì‹œê°„**: 0.5ì¼ (4 WU)

### êµ¬í˜„ ë‚´ìš©

#### 1. ëŒ€ì‹œë³´ë“œ ìœ„í—˜ ê±°ë˜ ìœ„ì ¯
**ì‹ ê·œ íŒŒì¼**: `frontend/components/reno/DealsAtRiskWidget.tsx`
- ê±´ê°•ë„ 50ì  ë¯¸ë§Œ ê³ ê° ëª©ë¡ í‘œì‹œ
- `/api/reno/deals-at-risk` API í˜¸ì¶œ
- í´ë¦­ ì‹œ ê³ ê° ìƒì„¸ í˜ì´ì§€ ì´ë™
- ëª¨ë“  ê³ ê°ì´ ê±´ê°•í•  ë•Œ ì¶•í•˜ ë©”ì‹œì§€ í‘œì‹œ

**í†µí•© ìœ„ì¹˜**: `frontend/app/(dashboard)/page.tsx:134`
```tsx
<DealsAtRiskWidget />
```

#### 2. ê³ ê° ìƒì„¸ í˜ì´ì§€ ê±´ê°•ë„ ë°°ì§€
**ì‹ ê·œ íŒŒì¼**: `frontend/components/reno/DealHealthBadge.tsx`
- í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ê±´ê°•ë„ ì¡°íšŒ
- 0-100ì  ì ìˆ˜ + ìƒ‰ìƒ ì½”ë”© (ë¹¨ê°•/ì£¼í™©/ë…¸ë‘/ì´ˆë¡)
- íŠ¸ë Œë“œ ì•„ì´ì½˜ (â†‘ improving, â†’ stable, â†“ declining)
- 5ê°€ì§€ ê±´ê°• ìš”ì¸ hover íˆ´íŒ
- ìƒˆë¡œê³ ì¹¨ ë° ìƒì„¸ ë³´ê¸° ë²„íŠ¼

**í†µí•© ìœ„ì¹˜**: `frontend/components/customers/CustomerDetail.tsx:156`
```tsx
<DealHealthBadge customerId={customer.id} />
```

#### 3. AISidebar í†µí•© í™•ì¸
- `frontend/app/(dashboard)/layout.tsx:124`ì—ì„œ ì´ë¯¸ í†µí•©ë˜ì–´ ìˆìŒì„ í™•ì¸
- `frontend/app/(dashboard)/page.tsx:134`ì—ì„œ DealsAtRiskWidget ì´ë¯¸ í†µí•©ë¨ í™•ì¸

### ë¹Œë“œ ê²°ê³¼
âœ… ì„±ê³µ (2026-01-25)

---

## Phase 2: ìë™ íŠ¸ë¦¬ê±°

**ì»¤ë°‹**: `d707c24`
**ì‘ì—… ì‹œê°„**: 1ì¼ (8 WU)

### êµ¬í˜„ ë‚´ìš©

#### 1. ë¯¸íŒ…ë…¸íŠ¸ íŒ”ë¡œì—… ë©”ì¼ ìƒì„±

**ìˆ˜ì • íŒŒì¼**: `frontend/components/meeting-notes/MeetingNoteDetail.tsx`
- ì¶”ê°€ëœ imports: `Mail, Loader2, FollowUpEmailModal`
- ì¶”ê°€ëœ state: `followUpModalOpen`
- íŒ”ë¡œì—… ë²„íŠ¼ ì¶”ê°€ (lines 142-152):
  - `customer_id`ê°€ ìˆì„ ë•Œë§Œ í‘œì‹œ
  - íŒŒë€ìƒ‰ ê°•ì¡° ìŠ¤íƒ€ì¼
- ëª¨ë‹¬ í†µí•© (lines 191-197)

**ì‹ ê·œ íŒŒì¼**: `frontend/components/meeting-notes/FollowUpEmailModal.tsx` (261ì¤„)
- `/api/reno/message-draft` API í˜¸ì¶œ
- ìš”ì²­ íŒŒë¼ë¯¸í„°:
  ```typescript
  {
    templateType: 'follow_up',
    customerId,
    context: { meetingNoteId, meetingNoteContent },
    save: false
  }
  ```
- í‘œì‹œ ë‚´ìš©:
  - ë©”ì¼ ì œëª© (subject)
  - ë³¸ë¬¸ (body)
  - í†¤ ì„¤ëª… (tone)
  - ëŒ€ì•ˆ í‘œí˜„ (alternatives)
  - ì‘ì„± íŒ (writingTips)
- ê¸°ëŠ¥:
  - ì œëª©/ë³¸ë¬¸ ê°œë³„ ë³µì‚¬ ë²„íŠ¼
  - ì¬ìƒì„± ë²„íŠ¼
  - ë¡œë”© ìƒíƒœ í‘œì‹œ

#### 2. ê³ ê° ëª©ë¡ ê±´ê°•ë„ ì»¬ëŸ¼

**ë°±ì—”ë“œ**: `server/routes/customerRoutes.ts`
- `includeHealthScore` ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¶”ê°€
- êµ¬í˜„ ë¡œì§ (lines 59-103):
  ```typescript
  const includeHealthScore = req.query.includeHealthScore === 'true';

  if (includeHealthScore && result.data.length > 0) {
    const healthQuery = `
      SELECT DISTINCT ON (customer_id)
        customer_id, score, trend
      FROM deal_health_scores
      WHERE customer_id = ANY($1)
      ORDER BY customer_id, created_at DESC
    `;
    const healthResult = await pool.query(healthQuery, [customerIds]);
    // Map scores to customers
  }
  ```
- `DISTINCT ON` íŒ¨í„´ìœ¼ë¡œ ê³ ê°ë‹¹ ìµœì‹  ì ìˆ˜ë§Œ ì¡°íšŒ
- LEFT JOIN ë°©ì‹ìœ¼ë¡œ ì ìˆ˜ ì—†ëŠ” ê³ ê°ë„ í¬í•¨

**í”„ë¡ íŠ¸ì—”ë“œ**: `frontend/components/customers/CustomerTable.tsx`
- ì»¬ëŸ¼ í—¤ë” ì¶”ê°€ (lines 440-442): "ê±´ê°•ë„"
- colspan 11â†’12 ë³€ê²½ (line 466)
- ê±´ê°•ë„ ì…€ ì¶”ê°€ (lines 567-594):
  ```tsx
  <td className="px-3 py-4">
    <Link href={`/customers/detail?id=${customer.id}`}>
      {health_score != null ? (
        <div className="flex items-center gap-1.5">
          <span className={colorClass}>{health_score}</span>
          <span>{trendIcon}</span>
        </div>
      ) : (
        <span className="text-gray-400">-</span>
      )}
    </Link>
  </td>
  ```
- ìƒ‰ìƒ ì½”ë”©:
  - 86-100: ì´ˆë¡ (bg-green-100)
  - 71-85: ë…¸ë‘ (bg-yellow-100)
  - 51-70: ì£¼í™© (bg-orange-100)
  - 0-50: ë¹¨ê°• (bg-red-100)

**íƒ€ì… ì •ì˜**: `frontend/hooks/useCustomers.ts`
```typescript
interface CustomerParams {
  includeHealthScore?: boolean;
  // ...
}
```

**API í˜¸ì¶œ**: `frontend/app/(dashboard)/customers/page.tsx:24`
```typescript
const { data, isLoading, refetch } = useCustomers({
  limit: 1000,
  includeHealthScore: true
});
```

### ë¹Œë“œ ê²°ê³¼
âœ… ì„±ê³µ (2026-01-25)

---

## Phase 3: ìë™í™”

**ì»¤ë°‹**: `38285dc`
**ì‘ì—… ì‹œê°„**: 0.5ì¼ (4 WU)

### êµ¬í˜„ ë‚´ìš©

#### 0. node-cron íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
npm install node-cron @types/node-cron
```
- `package.json`ì— ì¶”ê°€ë¨:
  - `"node-cron": "^4.2.1"`
  - `"@types/node-cron": "^3.0.11"`

#### 1. ë¯¸íŒ… ë¸Œë¦¬í•‘ ìë™ ìƒì„± í¬ë¡ 

**ì‹ ê·œ íŒŒì¼**: `server/cron/generateUpcomingMeetingBriefings.ts` (84ì¤„)

**ìŠ¤ì¼€ì¤„**: ë§¤ì¼ ìì • (0 0 * * *)

**ë¡œì§**:
1. Reno ì„œë¹„ìŠ¤ ê°€ìš©ì„± í™•ì¸
2. `meetingPrepGenerator.generateBriefingsForUpcomingMeetings(24)` í˜¸ì¶œ
   - 24ì‹œê°„ ì´ë‚´ ì˜ˆì •ëœ ë¯¸íŒ…ì˜ ë¸Œë¦¬í•‘ ìƒì„±
3. ì„±ê³µ/ì‹¤íŒ¨ ë¡œê·¸ ì €ì¥ (`cron_logs` í…Œì´ë¸”)

**í•µì‹¬ ì½”ë“œ**:
```typescript
export async function generateUpcomingMeetingBriefings(): Promise<CronLogResult> {
  const renoServices = getRenoServices();
  if (!renoServices) {
    await saveCronLog('meeting_briefing', false, 0, ['Reno services not available']);
    return { success: false, briefingsGenerated: 0, errors: [...] };
  }

  const briefings = await renoServices.meetingPrepGenerator
    .generateBriefingsForUpcomingMeetings(24);

  await saveCronLog('meeting_briefing', true, briefings.length, []);
  return { success: true, briefingsGenerated: briefings.length };
}
```

**ì—ëŸ¬ ì²˜ë¦¬**:
- Reno ì„œë¹„ìŠ¤ ì—†ìŒ â†’ ì—ëŸ¬ ë¡œê·¸ í›„ ìŠ¤í‚µ
- API í˜¸ì¶œ ì‹¤íŒ¨ â†’ ì—ëŸ¬ ë¡œê·¸ ì €ì¥
- ë¡œê·¸ëŠ” `cron_logs` í…Œì´ë¸”ì— ì €ì¥

#### 2. ìœ„í—˜ ê³ ê° Slack ì•Œë¦¼ í¬ë¡ 

**ì‹ ê·œ íŒŒì¼**: `server/cron/notifyDealsAtRisk.ts` (308ì¤„)

**ìŠ¤ì¼€ì¤„**: ë§¤ì¼ ì˜¤ì „ 9ì‹œ (0 9 * * *)

**ë¡œì§**:
1. Reno ì„œë¹„ìŠ¤ ë° Slack ì„¤ì • í™•ì¸
2. `dealHealthAnalyzer.getDealsAtRisk()` í˜¸ì¶œ (score < 50)
3. ê³ ê° ì •ë³´ ì¡°íšŒ (company_name, primary_contact_wb)
4. ê° ìœ„í—˜ ê³ ê°ì— ëŒ€í•´:
   - ë‹´ë‹¹ì ì—†ìœ¼ë©´ ìŠ¤í‚µ
   - ìµœê·¼ ì•Œë¦¼ ì´ë ¥ í™•ì¸ (ì¤‘ë³µ ë°©ì§€)
   - ë‹´ë‹¹ì ì´ë©”ì¼ë¡œ Slack User ID ì¡°íšŒ
   - Slack DM ë°œì†¡ (ë¸”ë¡ ë©”ì‹œì§€)
   - ì•Œë¦¼ ì´ë ¥ ì €ì¥
5. ê²°ê³¼ ë¡œê·¸ ì €ì¥

**Slack ë©”ì‹œì§€ í¬ë§·**:
```typescript
const blocks = [
  {
    type: 'header',
    text: { type: 'plain_text', text: 'ğŸš¨ ê³ ê° ì£¼ì˜ ì•Œë¦¼', emoji: true }
  },
  {
    type: 'section',
    fields: [
      { type: 'mrkdwn', text: `*ê³ ê°ëª…:*\n${deal.companyName}` },
      { type: 'mrkdwn', text: `*ê±´ê°•ë„ ì ìˆ˜:*\n${deal.score}/100 (${trendIcon} ${trendText})` }
    ]
  },
  {
    type: 'section',
    text: {
      type: 'mrkdwn',
      text: `*ì¶”ì²œ ì•¡ì…˜:*\n${recommendations.map(r => `â€¢ ${r}`).join('\n')}`
    }
  },
  {
    type: 'actions',
    elements: [{
      type: 'button',
      text: { type: 'plain_text', text: 'ê³ ê° ìƒì„¸ ë³´ê¸°' },
      url: `${webAppBaseUrl}/customers/detail?id=${customerId}`
    }]
  }
];
```

**ì´ë©”ì¼ â†’ Slack User ID ë§¤í•‘**:
```typescript
async function findSlackUserByEmail(app: App, email: string): Promise<string | null> {
  try {
    const result = await app.client.users.lookupByEmail({ email });
    return result.user?.id || null;
  } catch (error) {
    console.error(`[Cron] Failed to find Slack user: ${email}`, error);
    return null;
  }
}
```
- ì´ë©”ì¼ í˜•ì‹: `${primaryContactWB}@workhub.biz`
- ì°¾ì§€ ëª»í•˜ë©´ ìŠ¤í‚µ (ì—ëŸ¬ ì•„ë‹˜)

**ì¤‘ë³µ ì•Œë¦¼ ë°©ì§€**:
```typescript
async function shouldSendNotification(customerId: string, currentScore: number): Promise<boolean> {
  // TODO: notification_history í…Œì´ë¸” ì²´í¬
  // í˜„ì¬ëŠ” í•­ìƒ true (í–¥í›„ êµ¬í˜„)
  return true;
}
```

#### 3. í¬ë¡  ìŠ¤ì¼€ì¤„ëŸ¬ ì´ˆê¸°í™”

**ì‹ ê·œ íŒŒì¼**: `server/cron/index.ts` (67ì¤„)

**í™˜ê²½ë³€ìˆ˜**: `CRON_ENABLED` (ê¸°ë³¸ê°’: true)

**ìŠ¤ì¼€ì¤„ ì„¤ì •**:
```typescript
export function setupCronJobs(): void {
  if (!CRON_ENABLED) {
    console.log('â° Cron jobs are disabled (CRON_ENABLED=false)');
    return;
  }

  // ë§¤ì¼ ìì •: ë¯¸íŒ… ë¸Œë¦¬í•‘ ìƒì„±
  cron.schedule('0 0 * * *', async () => {
    console.log('[Cron] Starting meeting briefing generation...');
    const result = await generateUpcomingMeetingBriefings();
    console.log(`[Cron] Meeting briefing result:`, result);
  }, { timezone: 'Asia/Seoul' });

  // ë§¤ì¼ ì˜¤ì „ 9ì‹œ: ìœ„í—˜ ê³ ê° ì•Œë¦¼
  cron.schedule('0 9 * * *', async () => {
    console.log('[Cron] Starting at-risk customer notifications...');
    const result = await notifyDealsAtRisk();
    console.log(`[Cron] At-risk notification result:`, result);
  }, { timezone: 'Asia/Seoul' });

  console.log('âœ… Cron jobs initialized');
  console.log('  - Meeting briefings: 0 0 * * * (midnight KST)');
  console.log('  - At-risk notifications: 0 9 * * * (9 AM KST)');
}
```

**íƒ€ì„ì¡´**: `Asia/Seoul` (KST, UTC+9)

**ìˆ˜ë™ íŠ¸ë¦¬ê±° í•¨ìˆ˜** (í…ŒìŠ¤íŠ¸ìš©):
```typescript
export async function triggerMeetingBriefings(): Promise<CronLogResult> {
  console.log('[Manual] Triggering meeting briefing generation...');
  return await generateUpcomingMeetingBriefings();
}

export async function triggerAtRiskNotifications(): Promise<CronLogResult> {
  console.log('[Manual] Triggering at-risk notifications...');
  return await notifyDealsAtRisk();
}
```

#### 4. ì„œë²„ í†µí•©

**ìˆ˜ì • íŒŒì¼**: `server/index.ts`
- Import ì¶”ê°€ (line 15):
  ```typescript
  import { setupCronJobs } from './cron/index.js';
  ```
- í˜¸ì¶œ ì¶”ê°€ (after line 283):
  ```typescript
  isServerReady = true;

  // Setup cron jobs
  setupCronJobs();

  console.log('');
  console.log('='.repeat(50));
  ```

#### 5. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

**ì‹ ê·œ íŒŒì¼**: `server/database/migrations/015_add_cron_logs_table.sql`

**í…Œì´ë¸” ì •ì˜**:
```sql
CREATE TABLE IF NOT EXISTS cron_logs (
  id SERIAL PRIMARY KEY,
  job_name VARCHAR(100) NOT NULL,           -- 'meeting_briefing', 'notify_at_risk'
  success BOOLEAN NOT NULL DEFAULT false,
  records_processed INTEGER DEFAULT 0,       -- ì²˜ë¦¬ëœ ë ˆì½”ë“œ ìˆ˜
  errors JSONB,                              -- ì—ëŸ¬ ë©”ì‹œì§€ ë°°ì—´
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_cron_logs_job_name ON cron_logs(job_name);
CREATE INDEX idx_cron_logs_created_at ON cron_logs(created_at DESC);
```

**ì¸ë±ìŠ¤**:
- `job_name`: ì‘ì—…ë³„ ì¡°íšŒ
- `created_at DESC`: ìµœê·¼ ë¡œê·¸ ì¡°íšŒ

**ìš©ë„**:
- í¬ë¡  ì‘ì—… ì‹¤í–‰ ì´ë ¥ ì¶”ì 
- ì„±ê³µ/ì‹¤íŒ¨ ëª¨ë‹ˆí„°ë§
- ì—ëŸ¬ ë””ë²„ê¹…

### ë¹Œë“œ ê²°ê³¼
âœ… ì„±ê³µ (2026-01-25)

---

## ê¸°ìˆ ì  ê²°ì •ì‚¬í•­

### 1. ê³ ê° ê±´ê°•ë„ ì¡°íšŒ ìµœì í™”
**ë¬¸ì œ**: ê³ ê° ëª©ë¡ì—ì„œ N+1 ì¿¼ë¦¬ ë°œìƒ ìš°ë ¤

**í•´ê²°**:
- `DISTINCT ON (customer_id)` íŒ¨í„´ìœ¼ë¡œ ì„œë¸Œì¿¼ë¦¬ 1íšŒë§Œ ì‹¤í–‰
- ê³ ê° ID ë°°ì—´(`ANY($1)`)ë¡œ IN ì ˆ ëŒ€ì‹  íš¨ìœ¨ì  ì¡°íšŒ
- í´ë¼ì´ì–¸íŠ¸ì—ì„œ Mapìœ¼ë¡œ O(1) ë§¤í•‘

### 2. ê±´ê°•ë„ ìƒ‰ìƒ ì½”ë”©
**ê¸°ì¤€** (4ë‹¨ê³„):
- 0-50: ë¹¨ê°• (ì¦‰ì‹œ ëŒ€ì‘ í•„ìš”)
- 51-70: ì£¼í™© (ì£¼ì˜ í•„ìš”)
- 71-85: ë…¸ë‘ (ì–‘í˜¸)
- 86-100: ì´ˆë¡ (ë§¤ìš° ê±´ê°•)

**ê·¼ê±°**:
- 50ì  ë¯¸ë§Œì€ ìœ„í—˜ ê³ ê° (Slack ì•Œë¦¼ íŠ¸ë¦¬ê±°)
- 70ì  ì´í•˜ëŠ” ì ì¬ì  ìœ„í—˜
- ì‹œê°ì ìœ¼ë¡œ ëª…í™•í•œ 4ë‹¨ê³„ êµ¬ë¶„

### 3. Slack ì•Œë¦¼ ì¤‘ë³µ ë°©ì§€
**í˜„ì¬**: `shouldSendNotification()` í•¨ìˆ˜ stub
**í–¥í›„**: `notification_history` í…Œì´ë¸” êµ¬í˜„
- 24ì‹œê°„ ë‚´ ë™ì¼ ê³ ê° ì•Œë¦¼ ë°©ì§€
- ì ìˆ˜ ë³€í™” 10ì  ì´ìƒì¼ ë•Œë§Œ ì¬ì•Œë¦¼

### 4. í¬ë¡  ì‘ì—… íƒ€ì„ì¡´
**ì„ íƒ**: `Asia/Seoul` (KST)
**ì´ìœ **:
- í•œêµ­ ì˜ì—…ì‹œê°„ ê¸°ì¤€
- ì˜¤ì „ 9ì‹œ ì•Œë¦¼ = ì—…ë¬´ ì‹œì‘ ì‹œì 
- ìì • ë¸Œë¦¬í•‘ = ë‹¤ìŒë‚  ë¯¸íŒ… ì¤€ë¹„

### 5. í™˜ê²½ë³€ìˆ˜ ì œì–´
**`CRON_ENABLED`**:
- ê¸°ë³¸ê°’: true
- ë¡œì»¬ ê°œë°œ: false (ë¶ˆí•„ìš”í•œ ì•Œë¦¼ ë°©ì§€)
- ìŠ¤í…Œì´ì§•/í”„ë¡œë•ì…˜: true

---

## ì£¼ìš” ë³€ê²½ íŒŒì¼ ëª©ë¡

### Phase 1 (ì»¤ë°‹: f33fd33)
```
frontend/components/reno/DealHealthBadge.tsx          (NEW, 243ì¤„)
frontend/components/reno/DealsAtRiskWidget.tsx        (NEW, 143ì¤„)
frontend/components/customers/CustomerDetail.tsx      (MODIFIED)
```

### Phase 2 (ì»¤ë°‹: d707c24)
```
frontend/components/meeting-notes/MeetingNoteDetail.tsx    (MODIFIED)
frontend/components/meeting-notes/FollowUpEmailModal.tsx   (NEW, 261ì¤„)
frontend/components/customers/CustomerTable.tsx            (MODIFIED)
frontend/hooks/useCustomers.ts                             (MODIFIED)
frontend/app/(dashboard)/customers/page.tsx                (MODIFIED)
server/routes/customerRoutes.ts                            (MODIFIED)
```

### Phase 3 (ì»¤ë°‹: 38285dc)
```
server/cron/generateUpcomingMeetingBriefings.ts      (NEW, 84ì¤„)
server/cron/notifyDealsAtRisk.ts                     (NEW, 308ì¤„)
server/cron/index.ts                                 (NEW, 67ì¤„)
server/index.ts                                      (MODIFIED)
server/database/migrations/015_add_cron_logs_table.sql  (NEW)
package.json                                         (MODIFIED)
package-lock.json                                    (MODIFIED)
```

**ì´ íŒŒì¼ ìˆ˜**: ì‹ ê·œ 8ê°œ, ìˆ˜ì • 6ê°œ

---

## ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
```bash
# í”„ë¡œë•ì…˜ DBì— ì‹¤í–‰ í•„ìš”
psql $DATABASE_URL < server/database/migrations/015_add_cron_logs_table.sql
```

**ê²€ì¦**:
```sql
-- í…Œì´ë¸” ì¡´ì¬ í™•ì¸
SELECT * FROM cron_logs LIMIT 1;

-- ì¸ë±ìŠ¤ í™•ì¸
\d cron_logs
```

### 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì •

**.env.prd** ë˜ëŠ” **docker-compose.prd.yml**:
```bash
CRON_ENABLED=true
SLACK_BOT_TOKEN=xoxb-your-token        # ê¸°ì¡´ ê°’ í™•ì¸
SLACK_SIGNING_SECRET=your-secret       # ê¸°ì¡´ ê°’ í™•ì¸
```

**.env.local** (ë¡œì»¬ ê°œë°œ):
```bash
CRON_ENABLED=false  # ë¡œì»¬ì—ì„œëŠ” í¬ë¡  ë¹„í™œì„±í™”
```

### 3. Slack ì•± ê¶Œí•œ í™•ì¸
**í•„ìš”í•œ ìŠ¤ì½”í”„**:
- `users:read.email` - ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ
- `chat:write` - DM ë°œì†¡

**OAuth & Permissions** í˜ì´ì§€ì—ì„œ í™•ì¸:
https://api.slack.com/apps/YOUR_APP_ID/oauth

### 4. í¬ë¡  ì‘ì—… ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (ì„ íƒ)
ì„œë²„ ì¬ì‹œì‘ í›„:
```typescript
import { triggerMeetingBriefings, triggerAtRiskNotifications } from './cron/index.js';

// ì¦‰ì‹œ ì‹¤í–‰í•˜ì—¬ í…ŒìŠ¤íŠ¸
await triggerMeetingBriefings();
await triggerAtRiskNotifications();
```

ë˜ëŠ” REST API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ (ê´€ë¦¬ì ì „ìš©):
```typescript
// server/routes/adminRoutes.ts
router.post('/cron/trigger/briefings', adminAuth, async (req, res) => {
  const result = await triggerMeetingBriefings();
  res.json(result);
});
```

### 5. ë¡œê·¸ ëª¨ë‹ˆí„°ë§
ë°°í¬ í›„ 24ì‹œê°„ í™•ì¸:
```sql
-- í¬ë¡  ë¡œê·¸ ì¡°íšŒ
SELECT * FROM cron_logs
ORDER BY created_at DESC
LIMIT 10;

-- ì„±ê³µë¥  í™•ì¸
SELECT
  job_name,
  COUNT(*) as total_runs,
  SUM(CASE WHEN success THEN 1 ELSE 0 END) as successful_runs,
  ROUND(100.0 * SUM(CASE WHEN success THEN 1 ELSE 0 END) / COUNT(*), 2) as success_rate
FROM cron_logs
GROUP BY job_name;
```

### 6. í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬
- Next.js ë¹Œë“œ í™•ì¸: `npm run build` (ì™„ë£Œë¨)
- ì •ì  íŒŒì¼ ìƒì„± í™•ì¸: `frontend/out/`
- Docker ì´ë¯¸ì§€ ë¹Œë“œ í…ŒìŠ¤íŠ¸

---

## í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ë¹Œë“œ í…ŒìŠ¤íŠ¸
- **Phase 1**: âœ… ì„±ê³µ (2026-01-25)
- **Phase 2**: âœ… ì„±ê³µ (2026-01-25)
- **Phase 3**: âœ… ì„±ê³µ (2026-01-25)

**ë¹Œë“œ ì‹œê°„**: ì•½ 19ì´ˆ

**ê²½ê³ **:
- ESLint ì„¤ì • ê²½ê³  (ê¸°ì¡´ ë¬¸ì œ, ê¸°ëŠ¥ ë¬´ê´€)

### ìˆ˜ë™ í…ŒìŠ¤íŠ¸ (ë¡œì»¬)
- [x] DealHealthBadge ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
- [x] DealsAtRiskWidget ëª©ë¡ í‘œì‹œ
- [x] ê³ ê° ëª©ë¡ ê±´ê°•ë„ ì»¬ëŸ¼ í‘œì‹œ
- [x] íŒ”ë¡œì—… ë©”ì¼ ìƒì„± ë²„íŠ¼ (ë¯¸íŒ…ë…¸íŠ¸)
- [x] íŒ”ë¡œì—… ë©”ì¼ ëª¨ë‹¬ API í˜¸ì¶œ
- [ ] í¬ë¡  ì‘ì—… ì‹¤í–‰ (ìˆ˜ë™ íŠ¸ë¦¬ê±° í•„ìš”)
- [ ] Slack DM ìˆ˜ì‹  (í”„ë¡œë•ì…˜ í™˜ê²½ í•„ìš”)

---

## ì‚¬ìš©ì ì„íŒ©íŠ¸

### ì˜ì—… ë‹´ë‹¹ì
1. **ê³ ê° ê±´ê°•ë„ ì¦‰ì‹œ í™•ì¸**:
   - ê³ ê° ëª©ë¡ì—ì„œ í•œëˆˆì— ìœ„í—˜ ê³ ê° íŒŒì•…
   - ìƒì„¸ í˜ì´ì§€ì—ì„œ 5ê°€ì§€ ê±´ê°• ìš”ì¸ ë¶„ì„

2. **íŒ”ë¡œì—… ë©”ì¼ ìë™ ìƒì„±**:
   - ë¯¸íŒ…ë…¸íŠ¸ ì‘ì„± í›„ í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ì´ˆì•ˆ ìƒì„±
   - ë³µì‚¬/ë¶™ì—¬ë„£ê¸°ë¡œ ì¦‰ì‹œ ë°œì†¡ ê°€ëŠ¥

3. **ìœ„í—˜ ê³ ê° Slack ì•Œë¦¼**:
   - ë§¤ì¼ ì•„ì¹¨ ë‹´ë‹¹ ê³ ê° ì¤‘ ìœ„í—˜ ê³ ê° ì•Œë¦¼
   - ì¶”ì²œ ì•¡ì…˜ í¬í•¨ìœ¼ë¡œ ì¦‰ì‹œ ëŒ€ì‘ ê°€ëŠ¥

### ì˜ì—… ê´€ë¦¬ì
1. **ëŒ€ì‹œë³´ë“œ ìœ„í—˜ ê³ ê° í˜„í™©**:
   - ì „ì²´ ìœ„í—˜ ê³ ê° í•œëˆˆì— íŒŒì•…
   - í´ë¦­ìœ¼ë¡œ ìƒì„¸ í˜ì´ì§€ ì´ë™

2. **ê³ ê° ëª©ë¡ í•„í„°ë§/ì •ë ¬**:
   - ê±´ê°•ë„ ê¸°ì¤€ ì •ë ¬ë¡œ ìš°ì„ ìˆœìœ„ ê²°ì •
   - ìƒ‰ìƒ ì½”ë”©ìœ¼ë¡œ ì‹œê°ì  íŒŒì•…

### ì‹œìŠ¤í…œ
1. **ë¯¸íŒ… ì¤€ë¹„ ìë™í™”**:
   - ì˜ˆì •ëœ ë¯¸íŒ… ë¸Œë¦¬í•‘ ì‚¬ì „ ìƒì„±
   - í˜ì´ì§€ ë¡œë“œ ì‹œê°„ ë‹¨ì¶•

2. **ëª¨ë‹ˆí„°ë§**:
   - í¬ë¡  ë¡œê·¸ë¡œ ìë™í™” ì‘ì—… ì¶”ì 
   - ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ íŒŒì•…

---

## í–¥í›„ ê°œì„  ì‚¬í•­

### 1. notification_history í…Œì´ë¸” êµ¬í˜„
**ëª©ì **: Slack ì•Œë¦¼ ì¤‘ë³µ ë°©ì§€

**ìŠ¤í‚¤ë§ˆ**:
```sql
CREATE TABLE notification_history (
  id SERIAL PRIMARY KEY,
  customer_id UUID NOT NULL REFERENCES customers(id),
  notification_type VARCHAR(50) NOT NULL,  -- 'at_risk', 'milestone', etc.
  score INTEGER,
  slack_user_id VARCHAR(50),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_notification_history_customer_type
  ON notification_history(customer_id, notification_type);
CREATE INDEX idx_notification_history_created_at
  ON notification_history(created_at DESC);
```

**ë¡œì§**:
```typescript
async function shouldSendNotification(customerId: string, currentScore: number): Promise<boolean> {
  const query = `
    SELECT score, created_at
    FROM notification_history
    WHERE customer_id = $1 AND notification_type = 'at_risk'
    ORDER BY created_at DESC
    LIMIT 1
  `;
  const result = await pool.query(query, [customerId]);

  if (result.rows.length === 0) return true;

  const lastNotification = result.rows[0];
  const hoursSince = (Date.now() - new Date(lastNotification.created_at).getTime()) / 3600000;

  // 24ì‹œê°„ ì´ë‚´ëŠ” ìŠ¤í‚µ, ë‹¨ ì ìˆ˜ê°€ 10ì  ì´ìƒ ë³€í–ˆìœ¼ë©´ ì¬ì•Œë¦¼
  if (hoursSince < 24) {
    return Math.abs(currentScore - lastNotification.score) >= 10;
  }

  return true;
}
```

### 2. ë¯¸íŒ… ìƒì„¸ í˜ì´ì§€ ë¸Œë¦¬í•‘ íƒ­
**ìœ„ì¹˜**: `frontend/components/meetings/MeetingDetail.tsx`
**ê¸°ëŠ¥**:
- í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ë¸Œë¦¬í•‘ ì¡°íšŒ
- "AI ë¸Œë¦¬í•‘" íƒ­ ì¶”ê°€
- ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼

### 3. ê±´ê°•ë„ ê¸°ì¤€ ì •ë ¬ ê¸°ëŠ¥
**ìœ„ì¹˜**: `frontend/components/customers/CustomerTable.tsx`
**í˜„ì¬**: ê±´ê°•ë„ ì»¬ëŸ¼ í‘œì‹œë§Œ
**ê°œì„ **:
- ì»¬ëŸ¼ í—¤ë” í´ë¦­ ì‹œ ì •ë ¬ (ì˜¤ë¦„ì°¨ìˆœ/ë‚´ë¦¼ì°¨ìˆœ)
- null ê°’ ì²˜ë¦¬ (ë§¨ ë’¤ë¡œ)

### 4. í¬ë¡  ì‘ì—… ê´€ë¦¬ UI
**ìœ„ì¹˜**: ìƒˆ í˜ì´ì§€ (`/admin/cron-logs`)
**ê¸°ëŠ¥**:
- í¬ë¡  ë¡œê·¸ ì¡°íšŒ (í…Œì´ë¸”)
- ì„±ê³µë¥  ì°¨íŠ¸
- ìˆ˜ë™ íŠ¸ë¦¬ê±° ë²„íŠ¼ (ê´€ë¦¬ì ì „ìš©)
- ì—ëŸ¬ ìƒì„¸ ë³´ê¸°

### 5. ê±´ê°•ë„ íˆìŠ¤í† ë¦¬ ì°¨íŠ¸
**ìœ„ì¹˜**: `frontend/components/reno/DealHealthBadge.tsx`
**ê¸°ëŠ¥**:
- ìµœê·¼ 30ì¼ ê±´ê°•ë„ ì¶”ì´ ì°¨íŠ¸
- ìš”ì¸ë³„ ë³€í™” ë¶„ì„
- ì¤‘ìš” ì´ë²¤íŠ¸ ë§ˆì»¤ (ë¯¸íŒ…, ê³„ì•½ ë“±)

---

## ì°¸ê³  ë¬¸ì„œ

- **PRD**: `/home/peterchung/WHCommon/ê¸°íš/ì§„í–‰ì¤‘/PRD-Reno-AI-Integration.md`
- **Reno AI ì•„í‚¤í…ì²˜**: `/home/peterchung/WHCommon/ê¸°íš/ì™„ë£Œ/PRD-Reno-AI-Agent.md`
- **ë°°í¬ ê°€ì´ë“œ**: `/home/peterchung/WHCommon/ë¬¸ì„œ/ê°€ì´ë“œ/ë°°í¬-ê°€ì´ë“œ-ì˜¤ë¼í´.md`

---

## ì»¤ë°‹ ì´ë ¥

| Phase | ì»¤ë°‹ í•´ì‹œ | ë©”ì‹œì§€ | íŒŒì¼ ìˆ˜ |
|-------|----------|--------|---------|
| 1 | `f33fd33` | feat(reno): Phase 1 - Basic Integration | 3ê°œ |
| 2 | `d707c24` | feat(reno): Phase 2 - Auto Triggers | 6ê°œ |
| 3 | `38285dc` | feat(reno): Phase 3 - Automation (Cron Jobs) | 7ê°œ |

**ì´ ë³€ê²½**: ì‹ ê·œ 8ê°œ, ìˆ˜ì • 6ê°œ

---

## ì‘ì—… ì™„ë£Œ ì‹œì 

**ë‚ ì§œ**: 2026. 01. 25.
**ì‹œê°„**: 23:45 (KST)
**ìƒíƒœ**: âœ… ì™„ë£Œ (3/3 ë‹¨ê³„)
